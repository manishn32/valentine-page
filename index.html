<div class="envelope" id="envelope">
  <div class="flap"></div>

  <div class="letter" id="letter">
    <h3 id="title">Will You Be My Valentine? ‚ù§Ô∏è</h3>
    <button id="yesBtn">Yes</button>
    <button id="noBtn">No</button>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js"></script>
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
  
import { getFirestore, collection, addDoc }
from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

/* üîΩ PASTE YOUR FIREBASE CONFIG HERE */
const firebaseConfig = {
   apiKey: "AIzaSyAt_RwhWPoBXVL8RNMMVXRckc4GCVFcRWw",
   authDomain: "valentine-c63b3.firebaseapp.com",
   projectId: "valentine-c63b3",
   storageBucket: "valentine-c63b3.firebasestorage.app",
   messagingSenderId: "406251981974",
   appId: "1:406251981974:web:af03ce19b021a2e2a446b7"
  };

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

  let noCount = 0;

  function openEnvelope() {
    document.getElementById("envelope").classList.add("open");
  }

  function saveResponse(answer) {
    db.collection("responses").add({
      answer: answer,
      time: new Date()
    });

    if (answer === "YES") {
      fadeEnvelope();
    } else {
      handleNo();
    }
  }

  function fadeEnvelope() {
    const env = document.getElementById("envelope");
    env.style.opacity = "0";
    setTimeout(() => {
      env.style.display = "none";
    }, 600);
  }

  function handleNo() {
    noCount++;
    const title = document.getElementById("title");
    const letter = document.getElementById("letter");

    if (noCount === 1) {
      shake(letter);
    } else if (noCount === 2) {
      title.innerText = "Please don‚Äôt abandon me ü•∫";
    } else if (noCount === 3) {
      title.innerText = "Love, please come with me ‚ù§Ô∏è";
    } else {
      title.innerText =
        "Life will have so many ups and downs, this is the only down for us I promise üíû";
    }
  }

  function shake(element) {
    element.animate(
      [
        { transform: 'translateX(0px)' },
        { transform: 'translateX(-12px)' },
        { transform: 'translateX(12px)' },
        { transform: 'translateX(-12px)' },
        { transform: 'translateX(12px)' },
        { transform: 'translateX(0px)' }
      ],
      { duration: 400 }
    );
  }

  // Wire up events (no inline onclick attributes needed)
  document.getElementById("envelope").addEventListener("click", openEnvelope);
  document.getElementById("yesBtn").addEventListener("click", (e) => {
    e.stopPropagation();
    saveResponse("YES");
  });
  document.getElementById("noBtn").addEventListener("click", (e) => {
    e.stopPropagation();
    saveResponse("NO");
  });
</script>
